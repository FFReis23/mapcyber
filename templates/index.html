<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>Striped Owl — Live Threat Intelligence</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<style>
body { margin:0; background:#0b1e33; font-family:monospace; }
#map { height:100vh; }

.header {
position:absolute;
top:20px;
left:50%;
transform:translateX(-50%);
color:#00ffcc;
z-index:1000;
font-size:20px;
}

.panel {
position:absolute;
bottom:20px;
left:20px;
background:rgba(0,0,0,0.7);
padding:15px;
color:#00ff41;
z-index:1000;
}
</style>
</head>

<body>

<div class="header">
STRIPED OWL SECURITY — REAL TIME INTEL
</div>

<div class="panel">
APIs Integradas:<br>
✔ AbuseIPDB<br>
✔ Shodan<br>
✔ VirusTotal
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>

var map = L.map('map').setView([20,0],2);

L.tileLayer(
'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png'
).addTo(map);

fetch('/threat-data')
.then(res => res.json())
.then(data => {

data.forEach(threat => {

let color = '#ff0033';

if(threat.source === "Shodan") color = '#ffaa00';
if(threat.source === "VirusTotal") color = '#00ffff';

L.circleMarker([threat.lat, threat.lng], {
radius:6,
color:color,
fillColor:color,
fillOpacity:0.8
})
.addTo(map)
.bindPopup(
"<b>IP:</b> " + threat.ip +
"<br><b>Source:</b> " + threat.source +
"<br><b>Country:</b> " + threat.country
);

});

});

</script>

</body>
</html>
